var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this);var e=new P2World;e.createBg(65535,this.stage),e.createPlane(Math.PI,0,this.stage.stageHeight),e.createPlane(-Math.PI/2,0,0),e.createPlane(Math.PI/2,this.stage.stageWidth,0);var i=e.createBoxBodyShape(this.stage.stageWidth,10,9999,p2.Body.KINEMATIC);e.drawBox(this.stage.stageWidth,10,i),i.position=[this.stage.stageWidth/2,this.stage.stageHeight-100],this.addChild(e),this.p2World=e},e.prototype.onClick=function(t){this.p2World.index++;var e,i,o=this.p2World.index,r=Math.random(),a=30+20*r;if(.3>r)e=this.p2World.createCircleBodyShape(a,o),i=this.p2World.drawCircle(a,e);else if(.6>r)e=this.p2World.createBoxBodyShape(a,a,o),i=this.p2World.drawBox(a,a,e);else{var n=2*a;e=this.p2World.createBoxBodyShape(a,n,o),i=this.p2World.drawBox(a,n,e)}e.position=[t.stageX,t.stageY],i.x=t.stageX,i.y=t.stageY},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var P2World=function(t){function e(){var e=t.call(this)||this;return e.skins=[],e.index=0,e.colors=[10],e.world=new p2.World({gravity:[0,800]}),e.colors[p2.Body.DYNAMIC]=16711680,e.colors[p2.Body.KINEMATIC]=65280,e.addEventListener(egret.Event.ENTER_FRAME,e.updateWorld,e),e}return __extends(e,t),e.prototype.createBg=function(t,e){void 0===t&&(t=0);var i=new egret.Sprite;i.graphics.beginFill(t,.5),i.graphics.drawRect(0,0,e.stageWidth,e.stageHeight),i.graphics.endFill(),this.addChild(i)},e.prototype.createPlane=function(t,e,i){void 0===t&&(t=Math.PI);var o=new p2.Plane,r=new p2.Body({mass:0});return r.addShape(o),r.angle=t,r.position[0]=e,r.position[1]=i,this.world.addBody(r),r},e.prototype.drawCircle=function(t,e){var i=new egret.Sprite,o=this.colors[e.type];return i.graphics.lineStyle(1,o,1),i.graphics.moveTo(0,0),i.graphics.lineTo(0,t),i.graphics.beginFill(o,.5),i.graphics.drawCircle(0,0,t),i.graphics.endFill(),i.x=e.position[0],i.y=e.position[1],i.name=e.id+"",this.addChild(i),this.skins.push(i),i},e.prototype.createCircleBodyShape=function(t,e,i){void 0===i&&(i=p2.Body.DYNAMIC);var o=new p2.Body({mass:1}),r=new p2.Circle({radius:t});return o.addShape(r),o.id=e,o.type=i,this.world.addBody(o),o},e.prototype.drawBox=function(t,e,i){var o=new egret.Sprite,r=this.colors[i.type];return o.graphics.lineStyle(1,r,1),o.graphics.beginFill(r,.5),o.graphics.drawRect(-t/2,-e/2,t,e),o.graphics.endFill(),o.x=i.position[0],o.y=i.position[1],o.name=i.id+"",this.addChild(o),this.skins.push(o),o},e.prototype.createBoxBodyShape=function(t,e,i,o){void 0===o&&(o=p2.Body.DYNAMIC);var r=new p2.Body({mass:1}),a=new p2.Box({width:t,height:e});return r.addShape(a),r.id=i,r.type=o,this.world.addBody(r),r},e.prototype.updateWorld=function(t){var e=1/60,i=this.skins;this.world.step(e);for(var o=this.world.bodies,r=o.length,a=i.length,n=0;r>n;n++)for(var s=o[n],d=0;a>d;d++){var p=i[d];s.id+""==p.name&&(p.x=s.position[0],p.y=s.position[1],p.rotation=180*s.angle/Math.PI)}},e}(egret.DisplayObjectContainer);__reflect(P2World.prototype,"P2World");