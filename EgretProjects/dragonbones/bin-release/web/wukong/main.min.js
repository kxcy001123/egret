var __reflect=this&&this.__reflect||function(e,t,o){e.__class__=t,o?o.push(t):o=[t],e.__types__=e.__types__?o.concat(e.__types__):o},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.createGameScene=function(){this.createMotorcycleExp()},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,o=RES.getRes(e);return t.texture=o,t},t.prototype.createMotorcycleExp=function(){this.container=new egret.DisplayObjectContainer,this.addChild(this.container),this.container.x=10,this.container.y=10,FrameAnimation.getIns().loop(),FrameAnimation.getIns().addFactoryByName("wukong");for(var e=["stand","run","atk"],t=0;100>t;t++)for(var o=0;o<e.length;o++){var n=e[o],r=FrameAnimation.getIns().getArmatureByName("wukong",n);FrameAnimation.getIns().addWorld(r);var i=r.getDisplay();i.x=Math.random()*this.stage.stageWidth,i.y=Math.random()*this.stage.stageHeight,this.container.addChild(i),r.animation.gotoAndPlay(n)}},t.prototype.onTicker=function(e){this._time||(this._time=e);var t=e,o=t-this._time;return this._time=t,dragonBones.WorldClock.clock.advanceTime(o/1e3),!1},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var FrameAnimation=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data={},t}return __extends(t,e),t.getIns=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.loop=function(){function e(e){var t=.008;return dragonBones.WorldClock.clock.advanceTime(t),!1}egret.startTick(e,this)},t.prototype.addFactoryByName=function(e){this.data[e]={};var t=RES.getRes(e+"_ske_json"),o=RES.getRes(e+"_tex_json"),n=RES.getRes(e+"_tex_png"),r=new dragonBones.EgretFactory;r.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(t)),r.addTextureAtlasData(new dragonBones.EgretTextureAtlas(n,o)),this.data[e]=r},t.prototype.addWorld=function(e){dragonBones.WorldClock.clock.add(e)},t.prototype.getArmatureByName=function(e,t){var o=this.data[e],n=o.buildArmature(t);return n},t.prototype.getDisplayByName=function(e,t){return this.getArmatureByName(e,t).getDisplay()},t.prototype.getAnimationByName=function(e,t){return this.getArmatureByName(e,t).animation},t}(egret.HashObject);__reflect(FrameAnimation.prototype,"FrameAnimation");